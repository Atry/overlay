# Test suite for MIXIN stdlib

# Import stdlib via outer symbol table
StdlibTest:
  - [stdlib]

# Test Layer 1: Type Construction

test_boolean_true:
  - [StdlibTest, constructors, "True"]
  - on_true:
      a: {}
    on_false:
      b: {}

test_boolean_false:
  - [StdlibTest, constructors, "False"]
  - on_true:
      a: {}
    on_false:
      b: {}

test_nat_zero:
  - [StdlibTest, constructors, Zero]
  - successor:
      argument: {}
      result: {}
    zero:
      result: z

test_nat_one:
  - [StdlibTest, constructors, Succ]
  - predecessor:
      - [StdlibTest, constructors, Zero]
    successor:
      argument: {}
      result: {}
    zero:
      result: z

# Test Layer 2: Boolean operations

test_boolean_and_true_true:
  - [StdlibTest, boolean, operations, BooleanAnd]
  - left:
      - [StdlibTest, constructors, "True"]
    right:
      - [StdlibTest, constructors, "True"]

test_boolean_and_true_false:
  - [StdlibTest, boolean, operations, BooleanAnd]
  - left:
      - [StdlibTest, constructors, "True"]
    right:
      - [StdlibTest, constructors, "False"]

test_boolean_or_false_false:
  - [StdlibTest, boolean, operations, BooleanOr]
  - left:
      - [StdlibTest, constructors, "False"]
    right:
      - [StdlibTest, constructors, "False"]

test_boolean_or_true_false:
  - [StdlibTest, boolean, operations, BooleanOr]
  - left:
      - [StdlibTest, constructors, "True"]
    right:
      - [StdlibTest, constructors, "False"]

# Test Layer 3: Nat Arithmetic (Church-encoded, non-recursive)

test_nat_add_zero_zero:
  - [StdlibTest, nat, arithmetic, NatAdd]
  - augend:
      - [StdlibTest, constructors, Zero]
    addend:
      - [StdlibTest, constructors, Zero]
    successor:
      argument: {}
      result: {}
    zero:
      result: z

test_nat_add_one_zero:
  - [StdlibTest, nat, arithmetic, NatAdd]
  - augend:
      - [StdlibTest, constructors, Succ]
      - predecessor:
          - [StdlibTest, constructors, Zero]
    addend:
      - [StdlibTest, constructors, Zero]
    successor:
      argument: {}
      result: {}
    zero:
      result: z

# Test Layer 4: Semigroup

test_nat_add_semigroup:
  - [StdlibTest, nat, semigroups, NatAddSemigroup]
  - Combine:
      left:
        - [StdlibTest, constructors, Succ]
        - predecessor:
            - [StdlibTest, constructors, Zero]
      right:
        - [StdlibTest, constructors, Succ]
        - predecessor:
            - [StdlibTest, constructors, Zero]

# Test Layer 5: Polymorphic equality

test_boolean_equality_true_true:
  - [StdlibTest, algorithms, comparison, PolyEquality]
  - equality_operator:
      - [StdlibTest, boolean, equality, BooleanEquality]
    left:
      - [StdlibTest, constructors, "True"]
    right:
      - [StdlibTest, constructors, "True"]
